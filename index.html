<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <title>Finance App</title>
  <link rel="stylesheet" href="https://diogotava.github.io/finance-app/css/style.css">
  <link rel="manifest" href="https://diogotava.github.io/finance-app/manifest.json">
  <meta name="theme-color" content="#4f46e5">
</head>

<body>

  <h1>üí∞ Finance Dashboard</h1>

  <button id="settingsBtn">‚öôÔ∏è Configura√ß√µes</button>

  <div id="settingsModal" class="modal hidden">
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3 style="margin: 0;">Configura√ß√£o GitHub</h3>
        <button id="closeSettingsBtn"
          style="width: auto; padding: 5px 10px; background: transparent; color: #333; margin: 0; font-size: 16px;">‚úï</button>
      </div>
      <input type="text" id="username" placeholder="GitHub Username" />
      <input type="text" id="token" placeholder="Personal Access Token" />
      <button id="saveAuth">Guardar</button>
    </div>
  </div>

  <!-- Modal de Edi√ß√£o de Transa√ß√£o -->
  <div id="editModal" class="modal hidden">
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3 style="margin: 0;">Editar Transa√ß√£o</h3>
        <button id="closeEditBtn"
          style="width: auto; padding: 5px 10px; background: transparent; color: #333; margin: 0; font-size: 16px;">‚úï</button>
      </div>
      <input type="hidden" id="editId" />
      <select id="editType"
        style="width: 100%; margin: 5px 0; padding: 10px; border-radius: 8px; border: 1px solid #ddd; background: white;">
        <option value="expense">Gasto</option>
        <option value="income">Recebimento</option>
      </select>
      <input type="date" id="editDate" />
      <input type="number" id="editAmount" placeholder="Valor" />
      <select id="editCategory"
        style="width: 100%; margin: 5px 0; padding: 10px; border-radius: 8px; border: 1px solid #ddd; background: white;">
        <!-- Categorias carregadas via JS -->
      </select>
      <input type="text" id="editDescription" placeholder="Descri√ß√£o" />
      <button id="saveEditBtn">Guardar Altera√ß√µes</button>
    </div>
  </div>

  <section class="card" id="dashboard">
    <h3>Resumo do M√™s</h3>
    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
      <p style="margin: 0;"><strong>Recebido:</strong> <span id="totalIncome" style="color: #10b981;">0‚Ç¨</span></p>
      <p style="margin: 0;"><strong>Gasto:</strong> <span id="totalSpent" style="color: #ef4444;">0‚Ç¨</span></p>
    </div>
    <p><strong>Balan√ßo:</strong> <span id="balance">0‚Ç¨</span></p>
    <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
    <p><strong>Or√ßamento:</strong> <span id="monthlyBudget">0‚Ç¨</span></p>
    <p><strong>Restante:</strong> <span id="remaining">0‚Ç¨</span></p>
    <div class="progress-bar">
      <div id="progress"></div>
    </div>
    <div style="margin-top: 15px; max-height: 250px; display: flex; justify-content: center;">
      <canvas id="categoryChart"></canvas>
    </div>
  </section>

  <section class="card">
    <h3>Definir Or√ßamento Mensal</h3>
    <input type="number" id="budgetInput" placeholder="Or√ßamento ‚Ç¨" />
    <button id="saveBudget">Guardar Or√ßamento</button>
  </section>

  <section class="card">
    <h3>Adicionar Transa√ß√£o</h3>
    <select id="type"
      style="width: 100%; margin: 5px 0; padding: 10px; border-radius: 8px; border: 1px solid #ddd; background: white;">
      <option value="expense">Gasto</option>
      <option value="income">Recebimento</option>
    </select>
    <input type="date" id="date" />
    <input type="number" id="amount" placeholder="Valor" />
    <select id="category"
      style="width: 100%; margin: 5px 0; padding: 10px; border-radius: 8px; border: 1px solid #ddd; background: white;">
      <!-- Categorias carregadas via JS -->
    </select>
    <input type="text" id="description" placeholder="Descri√ß√£o" />
    <button id="addBtn">Adicionar</button>
  </section>

  <section class="card">
    <h3>Gerir Categorias</h3>
    <select id="manageCategoryType"
      style="width: 100%; margin-bottom: 10px; padding: 10px; border-radius: 8px; border: 1px solid #ddd; background: white;">
      <option value="expense">Gastos</option>
      <option value="income">Recebimentos</option>
    </select>
    <ul id="categoriesList" style="list-style: none; padding: 0; margin-bottom: 15px;"></ul>
    <div style="display: flex; gap: 10px; align-items: stretch;">
      <input type="text" id="newCategory" placeholder="Nova Categoria" style="flex: 1;" />
      <button id="addCategoryBtn" style="width: auto; padding: 0 15px;">Adicionar</button>
    </div>
  </section>

  <section>
    <h3>Transa√ß√µes</h3>
    <div id="transactions"></div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://diogotava.github.io/finance-app/js/api.js"></script>
  <script src="https://diogotava.github.io/finance-app/js/storage.js"></script>
  <script src="https://diogotava.github.io/finance-app/js/app.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('https://diogotava.github.io/finance-app/service-worker.js')
        .then(reg => console.log('Service Worker registado'))
        .catch(err => console.error('Erro no SW:', err));
    }
  </script>

</body>

</html>